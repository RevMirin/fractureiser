### График

Временная шкала идет снизу вверх. Самые важные события — самые последние.

---
*09.06.2023, 07:48 UTC*

Создатели Stage3b (skyrage), по-видимому, потеряли свой домен skyrage.de (записи сервера имен и регистратора изменились, записи dns исчезли)

---
*08.06.2023, 10:50 UTC*

Текущие C&C-серверы stage3b (skyrage) `95[.].214.27.172` и `171[.]22.30.117` больше недоступны. Следите за возможными изменениями DNS.

Время — это когда это заметили, а не когда это произошло.

---
*08.06.2023, 05:11 UTC*

Проспект сообщает следующее:

> Обновление от Modrinth, все файлы загружены за последние 10 месяцев
> (примерно половина наших файлов) проверены и ни один не заражен
> файл найден.

---
*08.06.2023, 01:12 UTC*

В основном все снова наладилось, антивирусные сканеры начали детектировать стадию 1+
jars как вредоносный, и на следующее утро в США запланировано совещание по дальнейшим действиям.

Встреча будет полуприватной, но записи/минуты будут доступны позже.

CurseForge сканирует все моды, но этот процесс все еще продолжается.

---
*2023-06-07 18:51 UTC*

Второй C&C-сервер 107[.]189.3.101 был заблокирован хостинг-провайдером.

---
*07.06.2023, 16:00 UTC*

Из-за задержки в HackMD этот документ был перенесен в репозиторий GitHub.
https://github.com/fractureiser-Investigation/fractureiser

---
*07.06.2023, 14:40 UTC*

Необфусцированная стадия 3 была заменена на обфусцированную, затем на другую
полезная нагрузка.

Эта полезная нагрузка — средство обновления Skyrage, известное вредоносное ПО Minecraft, нацеленное на кран.
серверы.

Некоторое время обслуживая Skyrage, он снова переключился на обслуживание взломанного клиента Meteor.

(TODO этот таймфрейм не совсем точен)

---
*07.06.2023, 14:20 UTC*

Анализ нового IP-адреса дает полностью деобфусцированный этап 3, по-видимому, загруженный случайно.
Он был заархивирован здесь: https://github.com/clrxbl/NekoClient

---
*07.06.2023, 14:19 UTC*

Домен страниц Cloudflare был отключен.

---
*07.06.2023, 14:05 UTC*

Домен страниц Cloudflare переключился на новый IP-адрес 107.189.3.101.

---


*07.06.2023, 08:52 UTC*

Пыль в основном уже осела. У нас есть хорошее представление о ранних стадиях вредоносного ПО, и стадия 3 подвергается обратному проектированию. Первый этап временно неактивен.

Мы возобновим обновления на следующее утро по американскому времени (или около того).

----
*07.06.2023, 08:09 UTC*

Мы все еще работаем над реверсированием этапа 3, технические подробности см. в разделе ниже.

----
*07.06.2023, 07:37 UTC*

CurseForge опубликовали следующее заявление на своем канале Discord #news:

> Привет всем,
>
> Мы хотели бы рассмотреть текущую ситуацию, которая продолжается, и выделить некоторые важные моменты:
>
> * Злоумышленник создал несколько учетных записей и загрузил на платформу проекты, содержащие вредоносное ПО
> * Отдельно пользователь, принадлежащий Luna Pixel Studios (LPS), был взломан и использовался для загрузки аналогичного вредоносного ПО.
> * Мы заблокировали все аккаунты, относящиеся к этому, а также отключили LPS. Мы находимся в прямом контакте с командой LPS, чтобы помочь им восстановить доступ
> * Мы проверяем ВСЕ новые проекты и файлы, чтобы гарантировать вашу безопасность. Разумеется, мы <u>приостанавливаем процесс утверждения всех новых файлов до тех пор, пока эта проблема не будет решена</u>.
> * Удаление клиента CF не является рекомендуемым решением, поскольку оно не решит проблему и не позволит нам установить исправление. Мы работаем над инструментом, который поможет вам убедиться, что вы не подверглись ничему из этого. А пока обратитесь к информации, опубликованной в #current-issues.
> * Это актуально ТОЛЬКО для пользователей Minecraft
> * Для ясности **CurseForge не скомпрометирован! Ни одна учетная запись администратора не была взломана.**
>
> Мы работаем над этим, чтобы платформа оставалась безопасным местом для загрузки и обмена модами. Спасибо всем авторам и пользователям, которые помогают нам с выделением, мы ценим ваше сотрудничество и терпение ❤️
>
> Следите за обновлениями, и мы решим эту проблему.

----
*07.06.2023, 07:24 UTC*

Darkhax связался с представителями Curseforge, которые подтвердили, что уязвимые файлы были загружены через пользовательский интерфейс, а не через API.

Curseforge приостановил одобрение загрузки, пока разворачивается эта ситуация, и удалил множество зараженных файлов.

Они также изучают IP-адреса загрузчиков вредоносных файлов, чтобы выяснить, совпадают ли они с предыдущими запросами законных владельцев учетных записей.

----
*07.06.2023, 7:03 UTC*

Мы считаем, что обнаружили истинную функцию Stage3 (`client.jar`) и пытаемся задокументировать ее здесь. Это нехорошо, ребята.

Быстрая версия, пока мы приводим этот документ в форму: client.jar ищет *по всей файловой системе* файлы, похожие на jar-файлы модов, и заражает их Stage0. Это включает в себя *все кэши Gradle и Maven*, а также множество вещей, которые разработчики модов, вероятно, никогда не подумали бы проверить. Потенциальные масштабы и масштабы этой инфекции перешли от «пары странных модов» к *потенциально бесконечным*.

Мы полагаем, что именно так первоначально распространилась инфекция, и Curseforge, возможно, не был первоначальным вектором атаки.

----

*07.06.2023, 6:27 UTC*

Расследование замедлилось, и большая часть команды ложится спать. Unscribed открыл почтовый ящик для людей, которые могут отправлять образцы или другую полезную информацию. В настоящее время williewillus работает над очисткой и включением информации, представленной D3SL, в этот документ.

----

*07.06.2023, 6:20 UTC*

D3SL сообщает неофициальному Discord, что у них есть копия полной (не урезанной) версии 3 этапа `client.jar`, а также подробный анализ того, что делает вредоносное ПО. Они впервые заметили это несколько недель назад и провели глубокий анализ, в результате чего смогли получить полные копии всех полезных нагрузок.

----

*07.06.2023, 5:27 UTC*

Мы обнаружили потенциальный (усеченный) файл Stage 3; он сильно запутан и содержит собственную DLL полезной нагрузки, которая пытается украсть учетные данные из хранилища учетных данных Windows.

----

*07.06.2023, 4:57 UTC*

Файлы, загруженные в апреле, были обнаружены; либо даты подделываются, либо это продолжается еще дольше. Многие из учетных записей имеют время последней активности в 1999 году — вероятно, причуда старых учетных записей CurseForge, но все же примечательная.

Сотрудники Modrinth расследуют, не скомпрометированы ли какие-либо загруженные файлы. Быстрый просмотр недавно обновленных проектов выглядел нормально.

----
    
*07.06.2023, 4:40 UTC*

Масштабы этого компромисса кажутся большими, чем предполагалось изначально. Вредоносные файлы появились несколько недель назад, начиная с 20 мая. Мы заметили это только сегодня, потому что они скомпрометировали популярный модпак.

---

*07.06.2023, 3:38 UTC*


Сервер C&C был отключен провайдером сервера. Скорее всего, появится новый, если страница Cloudflare останется активной, мы следим за этим.

----

*07.06.2023, 3:26 UTC*

Нам прислал возможный jar-файл стадии 2 от анонимного пользователя, который утверждает, что работает на хосте сервера.

----

*07.06.2023, 2:26 UTC*

Канал #cfmalware EsperNet создан для координации обсуждений, которые происходили в нескольких гильдиях Discord и пространствах Matrix.

----

*07.06.2023, 00:40 UTC*

Команда, составившая этот документ, узнала о вредоносных файлах, включенных в несанкционированное обновление Better Minecraft.

----

*01.06.2023 по 04.06.2023*

D3SL с подозрением относится к потреблению вредоносными файлами ЦП и ОЗУ и начинает
расследование. Порядок действий:

1. Подозрение на запрос брандмауэра исполняемого файла Java приводит к его блокировке.
2. Невозможность доступа к самостоятельным службам приводит к тому, что средство просмотра событий показывает все порты tcpip.
    заблокирован
3. Netstat показывает массовое потребление портов через PID враждебного jar-файла.
4. Идентификация вредоносного javaw.exe, работающего под управлением подтвержденного вредоносного ПО libwebgl64.jar.

Отсюда Цалумен сыграл важную роль в оказании помощи с первоначальным обратным проектированием
обфусцированный код byte[] и ручной захват полного набора файлов с удаленного
направления.

Полные копии всех исходных файлов (включая деобфускацию), кроме lib.dll, переводы
все удаленные пункты назначения, а также отчет о процессе заражения и несколько
враждебные возможности были предоставлены через каналы Защитнику Windows и
Вредоносные программы. Curseforge также был уведомлен. Знания о вредоносном ПО не были переданы
публично в это время, чтобы не предупредить злоумышленников

----
